<p></p>
<div class="page-heading">
  <h3>{{ traduction.bilan }}</h3>
  <p *ngIf="rafraichissement" style="font-size: 12px;color: rgb(194, 9, 9);">
    <i class="fas fa-exclamation-triangle" style="font-size:20px ; color: rgb(194, 9, 9);"></i>&nbsp; {{traduction.rafraichissement2}}
  </p>

<div class="card mb-4">
  <div class="card-body">
    <div class="container-fluid">
      <div *ngIf="isCelluleCentrale" class="row">

        <!-- Liste des années de la campagne de certification -->
        <div class="col-lg-3">
          <div class="fw-bold form-label">{{traduction.dateCampagne}}</div>
          <select (change)="onchangeDate()" [(ngModel)]="selectedDate" style="width: 100%; height: 60%;">
            <option *ngFor="let l of v3dropdownListDatestage1" value="{{l.substr}}">{{l.substr}}</option>
          </select>
        </div>

        <!-- Liste des noms de la campagne de certification -->
        <div class="col-lg-4">
          <div class="fw-bold form-label">{{traduction.nomCampagne}}</div>
          <select [(ngModel)]="selectedCertif" (change)="onchangeCertification()" style="width: 100%; height: 60%;">
            <option *ngFor="let l of v3dropdownListCampagnesStage1"
              value="{{l.nom_de_la_campagne_de_certification}}">
              {{l.nom_de_la_campagne_de_certification}}</option>
          </select>
        </div>

        <!-- Liste des noms des cellules locales -->
        <div class="col-lg-4">
          <div class="fw-bold form-label">{{traduction.nomCL}}</div>
          <select [(ngModel)]="selectedCL" style="width: 100%; height: 60%;">
            <option *ngFor="let l of listCellulesLocales"
              value="{{l}}">{{l}}</option>
          </select>
        </div>

        <div class="col-lg-1 text-center">
            <div class="form-row align-items-center">
                <label class="fw-bold form-label"> </label>
              </div>
              <button class="btn btn-secondary" name="btnGenerer" (click)="generateBilan()" style="background-color: #248e59"
                [disabled]="!selectedCertif">{{traduction.generate}}</button>
            </div>
          </div>
          
          <div *ngIf="isCelluleCentrale" class="row">
            <div class="col-lg-1"></div>
          
            <!-- Liste des années de la campagne de certification -->
            <div class="col-lg-4">
              <div class="fw-bold form-label">{{traduction.dateCampagne}}</div>
              <select (change)="onchangeDate()" [(ngModel)]="selectedDate" style="width: 70%; height: 60%;">
                <option *ngFor="let l of v3dropdownListDatestage1" value="{{l.substr}}">{{l.substr}}</option>
              </select>
            </div>
          
            <!-- Liste des noms de la campagne de certification -->
            <div class="col-lg-4">
              <div class="fw-bold form-label">{{traduction.nomCampagne}}</div>
              <select [(ngModel)]="selectedCertif" style="width: 85%; height: 60%;">
                <option *ngFor="let l of v3dropdownListCampagnesStage1"
                  value="{{l.nom_de_la_campagne_de_certification}}">
                  {{l.nom_de_la_campagne_de_certification}}</option>
              </select>
            </div>
          
            <div class="col-lg-2 text-center">
              <div class="form-row align-items-center">
                <label class="fw-bold form-label"> </label>
              </div>
              <button class="btn btn-secondary" name="btnGenerer" (click)="generateBilan()" style="background-color: #248e59"
                [disabled]="!selectedCertif">{{traduction.generate}}</button>
            </div>
          </div>
        </div>
      </div>
    </div>
          <div *ngIf="displayBilan && listParticipationByPole && listHabilitationByPole && bilan" class="card mb-4">
            <div class="card-body">
              <div class="container-fluid">
                <h5 class="text-center" style="color: #4a6575;">{{traduction.bilandroits}} ({{selectedDate}}){{traduction.droits}}({{poleBilan}})
                </h5>
                <div class="row" style="margin-top: 4%;">
                  <!-- Achievement en % -->
                  <div class="col-md-2">
                    <h5 class="text-center">{{traduction.achievement}}</h5>
                      <div style="width: 70%; margin: 0 auto;">
                        <circle-progress [percent]="achievement" [radius]="100" [outerStrokeWidth]="16" [innerStrokeWidth]="8" [outerStrokeColor]="'#248e59'"
                          [innerStrokeColor]="'#cbcbcb'" [animation]="true" [animationDuration]="300" [toFixed]="2"></circle-progress>
                      </div>
                    </div>
                  
          
                  <!-- Informations Sur Les Personnes -->
                  <div class="col-md-2">
                    <div class="form-label text-center">{{traduction.infoPersonnes}}</div>
                    <div class="fw-bold form-label text-center" style="margin-top: 8%;">{{traduction.beneficiaires}}</div>
                    <div class="fw-bold form-label text-center" style="color: #248e59;">{{beneficiaire}}</div>
                    <div class="fw-bold form-label text-center" style="margin-top: 8%;">{{traduction.certificators}}</div>
                    <div class="fw-bold form-label text-center" style="color: #248e59;">{{certificateur}}</div>
                  </div>
          
                  <!-- Informations Sur Les Ressources -->
                  <div class="col-md-2">
                    <div class="form-label text-center">{{traduction.infoRessources}}</div>
                    <div class="fw-bold form-label text-center" style="margin-top: 8%;">{{traduction.assets}}</div>
                    <div class="fw-bold form-label text-center" style="color: #248e59;">{{assets}}</div>
                    <div class="fw-bold form-label text-center" style="margin-top: 8%;">{{traduction.droits}}</div>
                    <div class="fw-bold form-label text-center" style="color: #248e59;">{{droits}}</div>
                    <div class="fw-bold form-label text-center" style="margin-top: 8%;">{{traduction.entitlements}}</div>
                    <div class="fw-bold form-label text-center" style="color: #248e59;">{{habilitations}}</div>
                  </div>
          
                  <!-- Résultats globaux -->
                  <div class="col-md-2">
                    <div class="form-label text-center">{{traduction.globalResults}}</div>
                    <div class="fw-bold form-label text-center" style="margin-top: 8%;">{{traduction.participation}}</div>
                    <div class="fw-bold form-label text-center" style="color: #248e59;">{{participation}} %</div>
                    <div class="fw-bold form-label text-center" style="margin-top: 8%;">{{traduction.habilitationsCertifiees}}</div>
                    <div class="fw-bold form-label text-center" style="color: #248e59;">{{habilitationsCertifiees}}</div>
                  </div>
            
                  <!-- Informations sur les habilitations approuvées, rejetées et non revues -->
                  <div class="col-md-3 text-center">
                  
                  <div>
                    <div class="shadowbox" style="display: inline-block; width: 70%; position: inherit;">
                      <div class="fw-bold form-label text-center">{{traduction.habilitationsApprouvees}}</div>
                      <div class="fw-bold form-label text-center" style="color: #248e59;">
                        {{habilitationsApprouvees}}</div>
                    </div>
                    <img src="assets/images/approuve.png" style="display: inline-block; width: 10%; margin-right: 10%; margin-left: -5%; margin-bottom: 4%;" />
                    <div class="fw-bold form-label text-center" style="color: #248e59; display: inline-block; width: 15%;">
                      {{habilitationsApprouveesPourcentage}} %</div>
                    </div>
                    <div>
            
                    <div class="shadowbox" style="display: inline-block; width: 70%;">
                      <div class="fw-bold form-label text-center">{{traduction.habilitationsRejetees}}</div>
                      <div class="fw-bold form-label text-center" style="color: #248e59;">
                        {{habilitationsRejetees}}</div>
                    </div>
                    <img src="assets/images/rejete.png" style="display: inline-block; width: 10%; margin-right: 10%; margin-left: -5%; margin-bottom: 4%;" />
                    <div class="fw-bold form-label text-center" style="color: #248e59; display: inline-block; width: 15%;">
                      {{habilitationsRejeteesPourcentage}} %</div>
                    </div>
                  <div>
                    <div class="shadowbox" style="display: inline-block; width: 70%;">
                      <div class="fw-bold form-label text-center">{{traduction.habilitationsNonRevues}}</div>
                      <div class="fw-bold form-label text-center" style="color: #248e59;">
                        {{habilitationsNonRevues}}</div>
                    </div>
                    <img src="assets/images/non-revu.png" style="display: inline-block; width: 10%; margin-right: 10%; margin-left: -5%; margin-bottom: 4%;" />
                    <div class="fw-bold form-label text-center" style="color: #248e59; display: inline-block; width: 15%;">
                      {{habilitationsNonRevuesPourcentage}} %</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
     
    <div>
   <div [ngClass]="{'d-none' : finishLoader}" class="text-center mt-5 pt-5">
                    <div class="spinner-border text-success"></div>
                  </div>
                </div>
                
                  <div *ngIf="displayBilan && listParticipationByPole && listHabilitationByPole && bilan" [ngClass]="{'d-none' : !finishLoader}" class="card mb-4">
                    <div class="card-body">
                      <div class="container-fluid">
                
                        <div class="row" style="margin-top: 2%;">
                
                          <!-- Participation par pôle -->
                          <div class="col-md-4">
                            <h5 class="text-center">{{traduction.participationPP}}</h5>
                            <div *ngFor="let p of listParticipationByPole" style="margin-top: 5%;">
                              <div class="form-label" style="display: inline-block; width: 50%; font-size: 85%;">
                                {{p.pole}}
                              </div>
                              <div style="display: inline-block; width: 35%;">
                                <div class="progress">
                                  <div class="progress-bar progress-bar-striped bg-success" role="progressbar" [style.width.%]="p.pourcentage" aria-valuenow="25"
                                    aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                              </div>
                              <div class="form-label text-center float-right" style="display: inline-block; width: 15%;">
                                {{p.pourcentage}} %
                              </div>
                            </div>
                          </div>
                
                          <!-- Habilitations revues par pôle -->
                          <div class="col-md-4">
                            <h5 class="text-center">{{traduction.habilitationsRevuesPP}}</h5>
                            <div *ngFor="let p of listHabilitationByPole" style="margin-top: 5%;">
                              <div class="form-label" style="display: inline-block; width: 50%; font-size: 85%;">
                                {{p.pole}}
                              </div>
                              <div style="display: inline-block; width: 35%;">
                                <div class="progress">
                                    <div class="progress-bar progress-bar-striped bg-success" role="progressbar" [style.width.%]="p.pourcentage"
                                    aria-valuenow="0" aria-valuemax="100"></div>
                                </div>
                              </div>
                              <div class="form-label text-center float-right" style="display: inline-block; width: 15%;">
                                {{p.pourcentage}} %
                              </div>
                            </div>
                          </div>
                    
                          <!-- statistiques du pôle par semaine -->
                          <div class="col-md-4">
                            <h5 class="text-center">{{traduction.statisticsPerWeek}}</h5>
                            <div *ngIf="statistiques">
                              <div *ngFor="let s of statistiques.statistics">
                                <h6 class="text-center" style="margin-top: 2%;">{{traduction.week}} {{s.semaine}}</h6>
                                <div style="width: 25%; margin: 0 auto;">
                                  <circle-progress [percent]="s.statistique" [radius]="100" [outerStrokeWidth]="16" [innerStrokeWidth]="8"
                                    [outerStrokeColor]="'#248e59'" [innerStrokeColor]="'#cbcbcb'" [animation]="true" [animationDuration]="300"
                                    [toFixed]="2"></circle-progress>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                    
          <div *ngIf="displayBilan && listParticipationByPole && listHabilitationByPole && bilan && listAchievementByCL && isCelluleCentrale && displayAchievementCL"
                      [ngClass]="{'d-none' : !finishLoader}" class="card mb-4">
                      <div class="card-body">
                        <div class="container-fluid">
                          <div class="row" style="margin-top: 2%;">
                    
                            <!-- Habilitations revues par pôle -->
                            <div class="col-md-8" style="margin: 0 auto;">
                              <h5 class="text-center">{{traduction.achievementParCL}}</h5>
                              <div *ngFor="let p of listAchievementByCL" style="margin-top: 5%;">
                                <div class="form-label" style="display: inline-block; width: 50%; font-size: 85%;">
                                    {{p.listeCL}}
                                  </div>
                                  <div style="display: inline-block; width: 35%;">
                                    <div class="progress">
                                      <div class="progress-bar progress-bar-striped bg-success" role="progressbar" [style.width.%]="p.achievement" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="form-label text-center float-right;" style="display: inline-block; width: 15%;">
                                    {{p.achievement}}%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
          </div>
    </div>        